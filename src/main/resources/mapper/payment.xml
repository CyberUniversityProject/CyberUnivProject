<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cyber.university.repository.interfaces.PaymentRepository">
	
	<!-- 24.03.20 결제 정보 조회 -->
	<select id="selectPaymentInfo" resultType="com.cyber.university.dto.PaymentInfoDto">
		select a.name, b.*
		from cu_student a
		join cu_tuition b on b.student_id = a.id
		where b.student_id = #{studentId} and b.tui_year = #{tuiYear} and b.semester = #{semester}
	</select>
	
	<!-- 24.03.20 년도, 학기 조회 -->
	<select id="selectTuiYearAndSemester" resultType="com.cyber.university.dto.PaymentInfoDto">
		select tui_year, semester from cu_tuition group by tui_year, semester
	</select>
	
	<!-- 24.03.20 학생 이름 조회 -->
	<select id="selectStudentName" resultType="com.cyber.university.repository.model.Student">
		select * from cu_student where id = #{id}
	</select>
	
	<insert id="insertPayment">
		insert into cu_payment (u_id, m_id, buyer_name, sch_amount) 
		values (#{uId}, #{mId}, #{buyerName}, #{schAmount})
	</insert>
	
	<update id="updateTuition">
		UPDATE cu_tuition 
		SET status = #{status}
		WHERE student_id = #{studentId}
		and tui_year = #{tuiYear}
		and semester = #{semester}
	</update>
	
</mapper>        
        